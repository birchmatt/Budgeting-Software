<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Budget Tracker</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<style>
* { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #eff6ff, #e0e7ff); min-height: 100vh; padding: 24px; }
.container { max-width: 1400px; margin: 0 auto; }
.header { margin-bottom: 32px; display: flex; justify-content: space-between; align-items: start; flex-wrap: wrap; gap: 16px; }
.header h1 { font-size: 2rem; font-weight: bold; color: #1f2937; }
.header p { color: #6b7280; font-size: 0.875rem; }
.btn-import { background: #2563eb; color: white; font-weight: 600; padding: 12px 24px; border-radius: 8px; border: none; cursor: pointer; display: inline-flex; align-items: center; gap: 8px; }
.btn-import:hover { background: #1d4ed8; }
.message { padding: 8px 12px; border-radius: 6px; font-size: 0.875rem; margin-top: 8px; }
.error { color: #dc2626; background: #fee2e2; }
.success { color: #16a34a; background: #dcfce7; }
.controls { background: white; border-radius: 12px; padding: 20px; margin-bottom: 24px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.control-row { display: flex; gap: 16px; align-items: center; flex-wrap: wrap; margin-bottom: 12px; }
.control-row:last-child { margin-bottom: 0; }
.control-label { font-weight: 600; color: #374151; min-width: 100px; }
.view-btn, .period-btn { padding: 8px 16px; border-radius: 6px; border: 2px solid #e5e7eb; background: white; cursor: pointer; font-size: 0.875rem; transition: all 0.2s; }
.view-btn:hover, .period-btn:hover { border-color: #2563eb; }
.view-btn.active, .period-btn.active { background: #2563eb; color: white; border-color: #2563eb; }
.nav-btn { padding: 8px 12px; border-radius: 6px; border: 1px solid #d1d5db; background: white; cursor: pointer; }
.nav-btn:disabled { opacity: 0.5; cursor: not-allowed; }
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 16px; margin-bottom: 24px; }
.stat-card { background: white; border-radius: 12px; padding: 24px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.stat-label { font-size: 0.875rem; color: #6b7280; margin-bottom: 8px; }
.stat-value { font-size: 1.75rem; font-weight: bold; margin-bottom: 4px; }
.stat-value.negative { color: #dc2626; }
.stat-value.neutral { color: #2563eb; }
.stat-note { font-size: 0.75rem; color: #9ca3af; }
.card { background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
.card.expense { border-left: 4px solid #dc2626; }
h2 { font-size: 1.25rem; font-weight: bold; color: #1f2937; margin-bottom: 16px; }
table { width: 100%; border-collapse: collapse; }
thead { background: #f3f4f6; }
th { text-align: left; padding: 12px; font-weight: 600; color: #374151; border-bottom: 2px solid #d1d5db; }
th.right { text-align: right; }
td { padding: 12px; border-bottom: 1px solid #e5e7eb; }
td.right { text-align: right; }
tbody tr:hover { background: #f9fafb; }
.total-row { background: #f3f4f6; font-weight: 600; }
.negative-value { color: #dc2626; }
.chart-container { position: relative; height: 400px; }
.charts-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(450px, 1fr)); gap: 24px; }
.loading { display: flex; align-items: center; justify-content: center; flex-direction: column; height: 100vh; gap: 16px; }
.hidden { display: none !important; }
</style>
</head>
<body>
<div id="loading" class="loading">
<p style="font-size: 1.25rem; color: #6b7280; margin-bottom: 24px;">Import CSV to get started</p>
<input type="file" id="fileInputLoading" accept=".csv" style="display: none;">
<label for="fileInputLoading" class="btn-import">Import CSV File</label>
</div>
<div id="app" class="container hidden">
<div class="header">
<div><h1>Budget Tracker</h1><p id="info">No data loaded</p></div>
<div><input type="file" id="fileInput" accept=".csv" style="display: none;"><label for="fileInput" class="btn-import">Import CSV</label><div id="msg"></div></div>
</div>
<div class="controls">
<div class="control-row">
<span class="control-label">View:</span>
<button class="view-btn" onclick="app.setView('day')">Day</button>
<button class="view-btn" onclick="app.setView('week')">Week</button>
<button class="view-btn active" onclick="app.setView('month')">Month</button>
<button class="view-btn" onclick="app.setView('year')">Year</button>
<button class="view-btn" onclick="app.setView('all')">All</button>
</div>
<div class="control-row hidden" id="yearRow">
<span class="control-label">Select Year:</span>
<div id="yearBtns" style="display: flex; gap: 8px; flex-wrap: wrap;"></div>
</div>
<div class="control-row hidden" id="periodRow">
<span class="control-label" id="periodLabel">Period:</span>
<button class="nav-btn" id="prevBtn" onclick="app.navigate(-1)">← Prev</button>
<button class="nav-btn" id="nextBtn" onclick="app.navigate(1)">Next →</button>
<div id="periodBtns" style="display: flex; gap: 8px; flex-wrap: wrap;"></div>
</div>
</div>
<div class="stats-grid">
<div class="stat-card"><div class="stat-label">Total Spending</div><div class="stat-value negative" id="totalSpend">$0</div><div class="stat-note" id="periodNote">-</div></div>
<div class="stat-card"><div class="stat-label">Avg per Day</div><div class="stat-value neutral" id="avgSpend">$0</div><div class="stat-note">Based on period</div></div>
<div class="stat-card"><div class="stat-label">Transactions</div><div class="stat-value neutral" id="txCount">0</div><div class="stat-note">Debit only</div></div>
<div class="stat-card"><div class="stat-label">Date Range</div><div class="stat-value neutral" style="font-size: 1.125rem;" id="dateRange">-</div><div class="stat-note" id="daysNote">-</div></div>
</div>
<div class="card expense">
<h2>Spending by Category</h2>
<table><thead><tr><th>Category</th><th class="right">Total</th><th class="right">Count</th><th class="right">%</th><th class="right">Avg</th></tr></thead><tbody id="catTable"></tbody></table>
</div>
<div class="charts-grid">
<div class="card"><h2>Spending Over Time</h2><div class="chart-container"><canvas id="timeChart"></canvas></div></div>
<div class="card"><h2>Category Breakdown</h2><div class="chart-container"><canvas id="pieChart"></canvas></div></div>
</div>
<div class="card"><h2>Top 10 Categories</h2><div class="chart-container"><canvas id="barChart"></canvas></div></div>
</div>
<script>
console.log('Starting app...');
var app = {
data: [], filtered: [], view: 'month', period: null, periods: [], selectedYear: null, years: [],
charts: { time: null, pie: null, bar: null },
init: function() {
console.log('Init app');
var self = this;
document.getElementById('fileInputLoading').onchange = function(e) { self.load(e); };
document.getElementById('fileInput').onchange = function(e) { self.load(e); };
},
load: function(e) {
console.log('File selected');
var file = e.target.files[0];
if (!file) return;
var reader = new FileReader();
var self = this;
reader.onload = function(ev) { self.parse(ev.target.result); };
reader.readAsText(file);
},
parse: function(text) {
console.log('Parsing CSV');
var self = this;
Papa.parse(text, {
header: true, dynamicTyping: true, skipEmptyLines: true,
complete: function(r) {
self.data = r.data.filter(function(row) { return row['Transaction Date'] && row['Credit Debit Indicator'] === 'Debit'; }).map(function(row) {
return {
date: new Date(row['Transaction Date']),
amount: Math.abs(row['Amount'] || 0),
category: (row['Category'] || 'Other').trim()
};
}).filter(function(t) { return !isNaN(t.date.getTime()); });
console.log('Loaded', self.data.length, 'transactions');
if (self.data.length === 0) { self.showMsg('No transactions found', true); return; }
self.showMsg('Loaded ' + self.data.length + ' transactions');
document.getElementById('loading').classList.add('hidden');
document.getElementById('app').classList.remove('hidden');
self.setView('month');
}
});
},
showMsg: function(txt, err) {
var div = document.getElementById('msg');
div.className = 'message ' + (err ? 'error' : 'success');
div.textContent = txt;
setTimeout(function() { div.textContent = ''; }, 4000);
},
setView: function(v) {
console.log('View:', v);
this.view = v;
this.period = null;
this.selectedYear = null;
var buttons = document.querySelectorAll('.view-btn');
for (var i = 0; i < buttons.length; i++) { buttons[i].classList.remove('active'); }
event.target.classList.add('active');
if (v === 'year') {
this.makeYears();
document.getElementById('yearRow').classList.remove('hidden');
document.getElementById('periodRow').classList.add('hidden');
} else if (v !== 'all') {
this.makePeriods();
document.getElementById('periodRow').classList.remove('hidden');
document.getElementById('yearRow').classList.add('hidden');
} else {
document.getElementById('periodRow').classList.add('hidden');
document.getElementById('yearRow').classList.add('hidden');
}
this.filter();
this.update();
},
makePeriods: function() {
var s = new Set();
var self = this;
this.data.forEach(function(t) {
var k;
if (self.view === 'day') k = t.date.toISOString().split('T')[0];
else if (self.view === 'week') { var d = new Date(t.date); d.setDate(d.getDate() - d.getDay()); k = d.toISOString().split('T')[0]; }
else if (self.view === 'month') k = t.date.getFullYear() + '-' + String(t.date.getMonth() + 1).padStart(2, '0');
if (k) s.add(k);
});
this.periods = Array.from(s).sort();
if (this.periods.length > 0) this.period = this.periods[this.periods.length - 1];
},
makeYears: function() {
var s = new Set();
this.data.forEach(function(t) { s.add(t.date.getFullYear()); });
this.years = Array.from(s).sort(function(a,b) { return b - a; });
if (this.years.length > 0) this.selectedYear = this.years[0];
},
setYear: function(y) {
this.selectedYear = y;
this.filter();
this.update();
},
setPeriod: function(p) {
this.period = p;
this.filter();
this.update();
},
navigate: function(dir) {
var i = this.periods.indexOf(this.period);
var n = i + dir;
if (n >= 0 && n < this.periods.length) {
this.period = this.periods[n];
this.filter();
this.update();
}
},
filter: function() {
var self = this;
if (this.view === 'all') { this.filtered = this.data; return; }
if (this.view === 'year') {
if (this.selectedYear) {
this.filtered = this.data.filter(function(t) { return t.date.getFullYear() === self.selectedYear; });
} else {
this.filtered = this.data;
}
return;
}
if (!this.period) { this.filtered = this.data; return; }
this.filtered = this.data.filter(function(t) {
var k;
if (self.view === 'day') k = t.date.toISOString().split('T')[0];
else if (self.view === 'week') { var d = new Date(t.date); d.setDate(d.getDate() - d.getDay()); k = d.toISOString().split('T')[0]; }
else if (self.view === 'month') k = t.date.getFullYear() + '-' + String(t.date.getMonth() + 1).padStart(2, '0');
return k === self.period;
});
},
update: function() {
this.updateYears();
this.updatePeriods();
this.updateStats();
this.updateTable();
this.updateCharts();
},
updateYears: function() {
if (this.view !== 'year') return;
var div = document.getElementById('yearBtns');
var self = this;
div.innerHTML = this.years.map(function(y) { return '<button class="view-btn ' + (y === self.selectedYear ? 'active' : '') + '" onclick="app.setYear(' + y + ')">' + y + '</button>'; }).join('');
},
updatePeriods: function() {
if (this.view === 'all' || this.view === 'year') return;
var div = document.getElementById('periodBtns');
var self = this;
div.innerHTML = this.periods.map(function(p) { return '<button class="period-btn ' + (p === self.period ? 'active' : '') + '" onclick="app.setPeriod(\'' + p + '\')">' + self.fmtPeriod(p) + '</button>'; }).join('');
var i = this.periods.indexOf(this.period);
document.getElementById('prevBtn').disabled = i <= 0;
document.getElementById('nextBtn').disabled = i >= this.periods.length - 1;
},
fmtPeriod: function(k) {
if (this.view === 'day') return new Date(k).toLocaleDateString('en-US', {month: 'short', day: 'numeric', year: 'numeric'});
if (this.view === 'month') { var p = k.split('-'); return new Date(p[0], p[1]-1).toLocaleDateString('en-US', {month: 'long', year: 'numeric'}); }
if (this.view === 'week') { var s = new Date(k); var e = new Date(s); e.setDate(e.getDate() + 6); return s.toLocaleDateString('en-US', {month: 'short', day: 'numeric'}) + ' - ' + e.toLocaleDateString('en-US', {month: 'short', day: 'numeric'}); }
return k;
},
updateStats: function() {
var tot = this.filtered.reduce(function(s, t) { return s + t.amount; }, 0);
var dates = this.filtered.map(function(t) { return t.date; });
var min = dates.length > 0 ? new Date(Math.min.apply(null, dates)) : null;
var max = dates.length > 0 ? new Date(Math.max.apply(null, dates)) : null;
var days = min && max ? Math.ceil((max - min) / 86400000) + 1 : 0;
var avg = days > 0 ? tot / days : 0;
document.getElementById('totalSpend').textContent = '$' + tot.toFixed(2);
document.getElementById('avgSpend').textContent = '$' + avg.toFixed(2);
document.getElementById('txCount').textContent = this.filtered.length;
if (min && max) {
document.getElementById('dateRange').textContent = min.toLocaleDateString('en-US', {month: 'short', day: 'numeric'}) + ' - ' + max.toLocaleDateString('en-US', {month: 'short', day: 'numeric', year: 'numeric'});
document.getElementById('daysNote').textContent = days + ' day' + (days !== 1 ? 's' : '');
}
document.getElementById('periodNote').textContent = this.view === 'year' && this.selectedYear ? this.selectedYear : (this.period ? this.fmtPeriod(this.period) : 'All time');
document.getElementById('info').textContent = this.data.length + ' total • Viewing: ' + (this.view === 'year' && this.selectedYear ? this.selectedYear : (this.period ? this.fmtPeriod(this.period) : 'All'));
},
updateTable: function() {
var m = {};
this.filtered.forEach(function(t) { if (!m[t.category]) m[t.category] = {tot: 0, cnt: 0}; m[t.category].tot += t.amount; m[t.category].cnt++; });
var cats = Object.entries(m).map(function(e) { return {name: e[0], tot: e[1].tot, cnt: e[1].cnt, avg: e[1].tot/e[1].cnt}; }).sort(function(a,b) { return b.tot - a.tot; });
var tot = cats.reduce(function(s, c) { return s + c.tot; }, 0);
var rows = cats.map(function(c) { return '<tr><td>' + c.name + '</td><td class="right negative-value">$' + c.tot.toFixed(2) + '</td><td class="right">' + c.cnt + '</td><td class="right">' + (tot > 0 ? (c.tot/tot*100).toFixed(1) : 0) + '%</td><td class="right">$' + c.avg.toFixed(2) + '</td></tr>'; }).join('');
var totalRow = '<tr class="total-row"><td>Total</td><td class="right">$' + tot.toFixed(2) + '</td><td class="right">' + this.filtered.length + '</td><td class="right">100%</td><td class="right">$' + (this.filtered.length > 0 ? (tot/this.filtered.length).toFixed(2) : '0.00') + '</td></tr>';
document.getElementById('catTable').innerHTML = rows + totalRow;
},
updateCharts: function() {
var tm = {};
var self = this;
this.filtered.forEach(function(t) {
var k;
if (self.view === 'year') k = String(t.date.getMonth() + 1).padStart(2, '0');
else if (self.view === 'all') k = t.date.getFullYear() + '-' + String(t.date.getMonth() + 1).padStart(2, '0');
else if (self.view === 'month' || self.view === 'week') k = t.date.toISOString().split('T')[0];
else if (self.view === 'day') k = String(t.date.getHours()).padStart(2, '0') + ':00';
if (!tm[k]) tm[k] = 0;
tm[k] += t.amount;
});
var td = Object.entries(tm).map(function(e) { return {p: e[0], a: e[1]}; }).sort(function(a,b) { return a.p.localeCompare(b.p); });
var monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
var labels = this.view === 'year' ? td.map(function(d) { return monthNames[parseInt(d.p) - 1]; }) : td.map(function(d) { return d.p; });
var cm = {};
this.filtered.forEach(function(t) { if (!cm[t.category]) cm[t.category] = 0; cm[t.category] += t.amount; });
var cd = Object.entries(cm).map(function(e) { return {n: e[0], t: e[1]}; }).sort(function(a,b) { return b.t - a.t; });
var top = cd.slice(0, 10);
if (this.charts.time) this.charts.time.destroy();
this.charts.time = new Chart(document.getElementById('timeChart'), {
type: 'line',
data: { labels: labels, datasets: [{ label: 'Spending', data: td.map(function(d) { return d.a; }), borderColor: '#dc2626', backgroundColor: 'rgba(220,38,38,0.1)', fill: true }] },
options: { responsive: true, maintainAspectRatio: false, plugins: { tooltip: { callbacks: { label: function(c) { return '$' + c.parsed.y.toFixed(2); } } } }, scales: { y: { beginAtZero: true, ticks: { callback: function(v) { return '$' + v; } } } } }
});
if (this.charts.pie) this.charts.pie.destroy();
this.charts.pie = new Chart(document.getElementById('pieChart'), {
type: 'pie',
data: { labels: top.map(function(d) { return d.n; }), datasets: [{ data: top.map(function(d) { return d.t; }), backgroundColor: ['#0088FE','#00C49F','#FFBB28','#FF8042','#8884d8','#82ca9d','#ffc658','#ff7c7c','#8dd1e1','#d084d0'] }] },
options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { position: 'right' }, tooltip: { callbacks: { label: function(c) { return c.label + ': $' + c.parsed.toFixed(2); } } } } }
});
if (this.charts.bar) this.charts.bar.destroy();
this.charts.bar = new Chart(document.getElementById('barChart'), {
type: 'bar',
data: { labels: top.map(function(d) { return d.n; }), datasets: [{ label: 'Amount', data: top.map(function(d) { return d.t; }), backgroundColor: '#dc2626' }] },
options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true, ticks: { callback: function(v) { return '$' + v; } } } } }
});
}
};
window.addEventListener('DOMContentLoaded', function() { console.log('DOM ready'); app.init(); });
console.log('Script loaded');
</script>
</body>
</html>
